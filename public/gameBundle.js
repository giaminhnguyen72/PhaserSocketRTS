(()=>{"use strict";class t{constructor(t={keyboard:!1,mouse:!1}){this.tag="EVENTHANDLER",this.components=[],this.events=[],this.eventConfig=t,window.addEventListener("click",(t=>{this.events.push("click")})),window.addEventListener("keydown",(t=>{console.log(t.key),console.log(t.key),console.log(t.key),console.log(t.key),console.log(t.key),console.log(t.key),console.log(t.key),console.log(t.key),console.log(t.key)}))}update(t){console.log("Event Handler");for(var e=this.components.length,s=0;s<e;s++){var n=this.components[s];console.log("Has Component");var o=n.eventMap;for(var i of this.events)if(o){var r=o.get(i);r&&(r(),console.log("Has Ran"))}n.update(t)}this.events=[]}}class e{constructor(t,e){this.tag="GRAPHICS",this.graphicsConfig=t,this.components=[],document.documentElement.style.height="100%",document.documentElement.style.width="100%",document.body.style.height="100%",document.body.style.width="100%",document.body.style.margin="0",this.entities=[],this.contextInfo=e}update(t){var e=this.contextInfo.ctx;for(var s of(console.log("Graphics"),console.log(this.contextInfo.canvas.width),console.log(this.contextInfo.canvas.height),console.log("Graphics engine running"),e.clearRect(0,0,e.canvas.width,e.canvas.height),this.components))console.log(s.componentId),s.update(t,e),console.log("Inside Graphics Component"),console.log(s.componentId)}setScene(t){t.engineComponents.get(this.tag)}}class s{constructor(){this.tag="PHYSICS",this.components=[]}update(t){for(var e of(console.log("Physics engine running"),this.components))e.update(t)}}class n{constructor(){this.tag="SCRIPTING",this.components=[]}update(t){for(var e of(console.log("Scripting engine running"),this.components))console.log("Component running"),e.callback(t)}}class o{constructor(t){this.graphicsConfig=t,this.graphicsConfig=t,document.documentElement.style.height="100%",document.documentElement.style.width="100%",document.body.style.height="100%",document.body.style.width="100%",document.body.style.margin="0",this.setup(),this.canvas=this.generateCanvas(),this.canvas.width=1e3,this.canvas.height=500,this.ctx=this.canvas.getContext("2d"),this.div=this.generateDiv(this.graphicsConfig.parent)}generateDiv(t){var e=document.createElement("div");return e.id=t,e.style.position="absolute",e.style.height="100%",e.style.width="100%",e.style.zIndex="1",e.style.backgroundImage="/images/test.jpg",e.appendChild(this.canvas),document.body.appendChild(e),console.log("test"),e}generateCanvas(){var t=document.createElement("CANVAS");return t.id=this.graphicsConfig.canvasID,console.log(this.parseStyle(this.graphicsConfig.style)),console.log("Before"),t.setAttribute("style",this.parseStyle(this.graphicsConfig.style)),t}getCtx(){return this.getCanvas().getContext("2d")}getCanvas(){var t=document.getElementById(this.graphicsConfig.canvasID);if(t instanceof HTMLCanvasElement)return t;throw Error("engineCanvas should be a reserved id for DOM Components")}parseStyle(t){var e=Object.entries(t).map((([t,e])=>t+":"+e+";"));return console.log(this.graphicsConfig.parent),e.join(" ")}setup(){var t=new Image;t.src="/images/test.jpg",t.style.position="absolute",t.style.zIndex="-1",t.style.width="100%",t.style.height="100%",document.body.appendChild(t)}}class i{constructor(t="engineDiv",e="engineCanvas",s={},n){this.parent=t,this.canvasID=e,this.style=s,this.background=n}}class r{constructor(t,e=[],s){this.name=t,this.entities=e,this.background=s}}class h{constructor(t){this.scene=t}addEntity(t){var e=c.getUniqueId();for(var s of(t.id=e,t.scene=this.scene,this.scene.entities.set(e,t),t.components)){var n=this.scene.engineComponents.get(s.engineTag);if(!n){for(var o of(console.log(s.engineTag),this.scene.engineComponents.keys()))console.log(o);throw Error("something wrong adding entities")}n.push(this.createComponent(s))}}removeEntity(t){var e=this.getEntity(t);if(e)for(var s of e.components){var n=this.scene.engineComponents.get(s.engineTag);if(n)for(var o=0;o<n.length;o++)n[o].entity==e&&n.splice(o,1)}return e}getEntity(t){return this.scene.entities.get(t)}createComponent(t){return t.componentId=c.getUniqueComponentId(),t}}class a{constructor(t,e,s){for(var n of(this.sceneManager=t,this.name=e.name,this.entities=new Map,this.engineComponents=new Map,this.entityManager=new h(this),s))this.engineComponents.set(n.tag,[]);for(var o of e.entities)this.addEntity(o);console.log(this.engineComponents),this.background=e.background,this.time=0}update(t){}addEntity(t){var e=c.getUniqueId();for(var s of(t.id=e,t.scene=this,this.entities.set(e,t),t.components)){var n=this.engineComponents.get(s.engineTag);n?n.push(this.createComponent(s)):console.log(s.engineTag+" tagged System is not found")}console.log("successfully added entity")}removeEntity(t){var e=this.getEntity(t);if(e)for(var s of e.components){var n=this.engineComponents.get(s.engineTag);if(n)for(var o=0;o<n.length;o++)n[o].entity==e&&n.splice(o,1)}return e}getEntity(t){return this.entities.get(t)}createComponent(t){return t.componentId=c.getUniqueComponentId(),t}}class c{constructor(t=[new r("Default")],e,s=t[0].name){this.sceneConfigs=t,this.scenes=new Map;for(var n=0;n<t.length;n++){var o=t[n];console.log("In Scene Manager"),console.log(e),this.scenes.set(o.name,new a(this,o,e))}this.sceneConfigs=t,this.currentIdx=s,this.systems=e}switchScenes(t){}getCurrentScene(){let t=this.scenes.get(this.currentIdx);if(t)return t;throw Error("Cant get current scene")}update(t){for(var e of this.scenes)e[1].update(t)}static getUniqueId(){return c.id++}static getUniqueComponentId(){return c.componentId++}}c.id=0,c.componentId=0;class g{constructor(){this.tag="COLLISION",this.components=[]}update(t){for(var e of(console.log("Collision System Running"),this.components))for(var s of this.components)e.checkCollision(s)&&e!=s&&e.collides(s)}}class l{constructor(i={isServer:!0},r){if(this.canvasID="engineCanvas",this.systems=[],this.time=0,this.engineConfig=i,i.graphicsConfig&&(this.contextInfo=new o(i.graphicsConfig)),this.engineConfig.eventConfig&&this.systems.push(new t(this.engineConfig.eventConfig)),this.engineConfig.physicsConfig&&this.systems.push(new s),this.engineConfig.scriptingConfig&&this.contextInfo&&this.systems.push(new n),r)for(var h of r)this.systems.push(h);for(var h of(this.engineConfig.collisionConfig&&this.systems.push(new g),this.engineConfig.graphicsConfig&&this.contextInfo&&(console.log("Console.context info"),console.log(this.contextInfo),this.graphics=new e(this.engineConfig.graphicsConfig,this.contextInfo),this.systems.push(this.graphics)),this.sceneManager=new c(this.engineConfig.sceneConfig,this.systems),this.running=!0,this.systems)){var a=this.sceneManager.getCurrentScene().engineComponents.get(h.tag);if(!a)throw Error("error in start method");h.components=a}this.running=!1}start(t){if(this.running=!0,this.graphics)window.requestAnimationFrame((t=>{let e=t-this.time;this.update(e),this.time=t}));else for(;this.running;)this.update(t)}update(t){for(var e of(console.log(this),this.systems))e.update(t);this.sceneManager.update(t),this.time+=t,console.log(this.time),window.requestAnimationFrame((t=>{let e=t-this.time;this.update(e),this.time=t}))}}class p{constructor(t,e={x:0,y:0,z:0},s={x:0,y:0,z:0},n={x:0,y:0,z:0}){this.engineTag="PHYSICS",this.entity=t,this.pos=e,this.vel=s,this.accel=n}update(t){console.log("Position is: "+this.pos.x+" and "+this.pos.y),this.vel.x=this.vel.x+this.accel.x*t,this.vel.y=this.vel.y+this.accel.y*t,this.vel.z=this.vel.z+this.accel.z*t,this.pos.x=this.pos.x+this.vel.x*t,this.pos.y=this.pos.y+this.vel.y*t,this.pos.z=this.pos.z+this.vel.z*t}}class m{update(t,e){if(e){var s=255*Math.random(),n=255*Math.random(),o=255*Math.random();e.fillStyle=`rgb(\n                ${s},\n                ${n},\n                ${o})`,e.fillRect(this.transform.pos.x,this.transform.pos.y,20,20)}}constructor(t,e){this.engineTag="GRAPHICS",this.entity=t,this.transform=e}render(t){if(t){var e=255*Math.random(),s=255*Math.random(),n=255*Math.random();t.fillStyle=`rgb(\n                ${e},\n                ${s},\n                ${n})`,t.fillRect(this.transform.pos.x,this.transform.pos.y,20,20)}}}class d{constructor(t,e){this.engineTag="EVENTHANDLER",this.entity=t,this.eventMap=new Map,Object.entries(e).map((([t,e])=>{this.eventMap.set(t,e)}))}update(t,e){console.log("In mouse Listener")}}class f{constructor(t){this.engineTag="SCRIPTING",this.callback=t}update(t,e){this.callback(t)}}class u{constructor(t,e,s){this.engineTag="COLLISION",this.entity=t,this.collideType="Box",this.shape={pos:e,dim:{length:20,height:20},rot:0},this.prev={x:e.x,y:e.y,z:e.z},this.onCollision=s}checkCollision(t){if(console.log("Checking Collision"),t instanceof u){let e=t.shape,s=this.shape;if(0==e.rot&&0==s.rot)return e.pos.x+e.dim.length>s.pos.x&&e.pos.x<s.pos.x+s.dim.length&&e.pos.y+e.dim.height>s.pos.y&&e.pos.y<s.pos.y+s.dim.height;console.log("slanted box")}else console.log("not box");return!1}collides(t){console.log("Collided"),this.onCollision(t)}update(t,e){console.log("Updating Box Collider"),this.prev.x=this.shape.pos.x,this.prev.y=this.shape.pos.y,this.prev.z=this.shape.pos.z}}class y{constructor(t,e){this.transform=new p(this,t,e);var s=new f((t=>{this.transform.pos.x,console.log("In Player Script"),this.transform.pos.x<0?(this.transform.pos.x=0,this.transform.vel.x*=-1):this.transform.pos.x+20>1e3&&(this.transform.pos.x=980,this.transform.vel.x*=-1),this.transform.pos.y<0?(this.transform.pos.y=0,this.transform.vel.y*=-1):this.transform.pos.y+20>500&&(this.transform.pos.y=480,this.transform.vel.y*=-1)}));this.renderer=new m(this,this.transform),this.listener=new d(this,{click:()=>{var t;this.transform.pos.x=1e3*Math.random(),this.transform.pos.y=500*Math.random(),this.transform.vel.y=1,this.transform.vel.x=1;var e=1e3*Math.random(),s=500*Math.random();null===(t=this.scene)||void 0===t||t.addEntity(new y({x:e,y:s,z:15},{x:1,y:1,z:0}))},test2:()=>{console.log("test2")}});var n=new u(this,this.transform.pos,(t=>{this.transform.vel.x*=-1,this.transform.vel.y*=-1}));this.components=[this.transform,this.renderer,this.listener,s,n]}}window.onload=()=>{new l({isServer:!1,physicsConfig:{},graphicsConfig:new i("test","193as",{"background-color":"white",width:"100%",height:"100%"}),sceneConfig:[{name:"as",entities:[new y({x:0,y:0,z:15},{x:.001,y:0,z:0})]}],eventConfig:{keyboard:!0,mouse:!0},scriptingConfig:{},collisionConfig:{}}).start(1)}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFVLEVBQ1ZFLGNBQWUsQ0FBQyxFQUNoQm5HLGVBQWdCLElBQUlxRCxFQUFlLE9BQVEsUUFBUyxDQUFFLG1CQUFvQixRQUFTLE1BQVMsT0FBUSxPQUFVLFNBQzlHcUIsWUFBYSxDQUNULENBQ0lsQixLQUFNLEtBQ04vQyxTQUFVLENBQ04sSUFBSWlJLEVBQU8sQ0FBRTVCLEVBQUcsRUFBR0MsRUFBRyxFQUFHQyxFQUFHLElBQU0sQ0FBRUYsRUFBRyxLQUFPQyxFQUFHLEVBQUdDLEVBQUcsT0FJbkV6SSxZQUFhLENBQ1RDLFVBQVUsRUFDVkMsT0FBTyxHQUVYMkgsZ0JBQWlCLENBQUMsRUFDbEJFLGdCQUFpQixDQUFDLElBRWZHLE1BQU0sRUFBRSxDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZW5naW5lLy4vZGlzdC9lbmdpbmUvc3JjL2V2ZW50cy9FdmVudEhhbmRsZXIuanMiLCJ3ZWJwYWNrOi8vZW5naW5lLy4vZGlzdC9lbmdpbmUvc3JjL2dyYXBoaWNzL0dyYXBoaWNFbmdpbmUuanMiLCJ3ZWJwYWNrOi8vZW5naW5lLy4vZGlzdC9lbmdpbmUvc3JjL2NvbnN0YW50cy9jb21wb25lbnRUeXBlLmpzIiwid2VicGFjazovL2VuZ2luZS8uL2Rpc3QvZW5naW5lL3NyYy9waHlzaWNzL1BoeXNpY3NFbmdpbmUuanMiLCJ3ZWJwYWNrOi8vZW5naW5lLy4vZGlzdC9lbmdpbmUvc3JjL3NjcmlwdGluZy9TY3JpcHRpbmdFbmdpbmUuanMiLCJ3ZWJwYWNrOi8vZW5naW5lLy4vZGlzdC9lbmdpbmUvc3JjL2NvcmUvY29udGV4dC5qcyIsIndlYnBhY2s6Ly9lbmdpbmUvLi9kaXN0L2VuZ2luZS9zcmMvY29yZS9jb25maWcuanMiLCJ3ZWJwYWNrOi8vZW5naW5lLy4vZGlzdC9lbmdpbmUvc3JjL2NvcmUvbWFuYWdlcnMvRW50aXR5TWFuYWdlci5qcyIsIndlYnBhY2s6Ly9lbmdpbmUvLi9kaXN0L2VuZ2luZS9zcmMvY29yZS9zY2VuZS5qcyIsIndlYnBhY2s6Ly9lbmdpbmUvLi9kaXN0L2VuZ2luZS9zcmMvY29yZS9tYW5hZ2Vycy9TY2VuZU1hbmFnZXIuanMiLCJ3ZWJwYWNrOi8vZW5naW5lLy4vZGlzdC9lbmdpbmUvc3JjL0NvbGxpc2lvbi9Db2xsaXNpb25TeXN0ZW0uanMiLCJ3ZWJwYWNrOi8vZW5naW5lLy4vZGlzdC9lbmdpbmUvc3JjL2NvcmUvZW5naW5lLmpzIiwid2VicGFjazovL2VuZ2luZS8uL2Rpc3QvZW5naW5lL3NyYy9jb21wb25lbnRzL1BoeXNpY3MvdHJhbnNmb3JtLmpzIiwid2VicGFjazovL2VuZ2luZS8uL2Rpc3QvZW5naW5lL3NyYy9jb21wb25lbnRzL0dyYXBoaWNzL1JlY3RhbmdsZS5qcyIsIndlYnBhY2s6Ly9lbmdpbmUvLi9kaXN0L2VuZ2luZS9zcmMvY29tcG9uZW50cy9FdmVudC9MaXN0ZW5lci5qcyIsIndlYnBhY2s6Ly9lbmdpbmUvLi9kaXN0L2VuZ2luZS9zcmMvY29tcG9uZW50cy9TY3JpcHQvU2NyaXB0LmpzIiwid2VicGFjazovL2VuZ2luZS8uL2Rpc3QvZW5naW5lL3NyYy9jb21wb25lbnRzL0NvbGxpc2lvbi9Db2xsaWRlci5qcyIsIndlYnBhY2s6Ly9lbmdpbmUvLi9kaXN0L0dhbWVGcm9udGVuZC9zY2VuZXMvZW50aXRpZXMvUGxheWVyLmpzIiwid2VicGFjazovL2VuZ2luZS8uL2Rpc3QvR2FtZUZyb250ZW5kL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBFdmVudEhhbmRsZXIge1xyXG4gICAgY29uc3RydWN0b3IoZXZlbnRDb25maWcgPSB7XHJcbiAgICAgICAga2V5Ym9hcmQ6IGZhbHNlLFxyXG4gICAgICAgIG1vdXNlOiBmYWxzZVxyXG4gICAgfSkge1xyXG4gICAgICAgIHRoaXMudGFnID0gXCJFVkVOVEhBTkRMRVJcIjtcclxuICAgICAgICB0aGlzLmNvbXBvbmVudHMgPSBbXTtcclxuICAgICAgICB0aGlzLmV2ZW50cyA9IFtdO1xyXG4gICAgICAgIHRoaXMuZXZlbnRDb25maWcgPSBldmVudENvbmZpZztcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmV2ZW50cy5wdXNoKFwiY2xpY2tcIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudC5rZXkpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudC5rZXkpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudC5rZXkpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudC5rZXkpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudC5rZXkpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudC5rZXkpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudC5rZXkpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudC5rZXkpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudC5rZXkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgdXBkYXRlKGR0KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJFdmVudCBIYW5kbGVyXCIpO1xyXG4gICAgICAgIHZhciBsZW4gPSB0aGlzLmNvbXBvbmVudHMubGVuZ3RoO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGNvbXAgPSB0aGlzLmNvbXBvbmVudHNbaV07XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSGFzIENvbXBvbmVudFwiKTtcclxuICAgICAgICAgICAgdmFyIGxpc3RlbmFibGUgPSBjb21wO1xyXG4gICAgICAgICAgICB2YXIgZXZlbnRNYXAgPSBsaXN0ZW5hYmxlLmV2ZW50TWFwO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBlIG9mIHRoaXMuZXZlbnRzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnRNYXApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZnVuYyA9IGV2ZW50TWFwLmdldChlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZnVuYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSGFzIFJhblwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29tcC51cGRhdGUoZHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmV2ZW50cyA9IFtdO1xyXG4gICAgfVxyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUV2ZW50SGFuZGxlci5qcy5tYXAiLCJpbXBvcnQgeyBHUkFQSElDU19UQUcgfSBmcm9tIFwiLi4vY29uc3RhbnRzL2NvbXBvbmVudFR5cGUuanNcIjtcclxuZXhwb3J0IGNsYXNzIEdyYXBoaWNzRW5naW5lIHtcclxuICAgIGNvbnN0cnVjdG9yKGdyYXBoaWNzQ29uZmlnLCBjb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy50YWcgPSBHUkFQSElDU19UQUc7XHJcbiAgICAgICAgdGhpcy5ncmFwaGljc0NvbmZpZyA9IGdyYXBoaWNzQ29uZmlnO1xyXG4gICAgICAgIHRoaXMuY29tcG9uZW50cyA9IFtdO1xyXG4gICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7XHJcbiAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLndpZHRoID0gJzEwMCUnO1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS53aWR0aCA9IFwiMTAwJVwiO1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUubWFyZ2luID0gXCIwXCI7XHJcbiAgICAgICAgdGhpcy5lbnRpdGllcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuY29udGV4dEluZm8gPSBjb250ZXh0O1xyXG4gICAgfVxyXG4gICAgdXBkYXRlKGR0KSB7XHJcbiAgICAgICAgdmFyIGN0eCA9IHRoaXMuY29udGV4dEluZm8uY3R4O1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiR3JhcGhpY3NcIik7XHJcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5jb250ZXh0SW5mby5jYW52YXMud2lkdGgpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuY29udGV4dEluZm8uY2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJHcmFwaGljcyBlbmdpbmUgcnVubmluZ1wiKTtcclxuICAgICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGN0eC5jYW52YXMud2lkdGgsIGN0eC5jYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICBmb3IgKHZhciBjb21wIG9mIHRoaXMuY29tcG9uZW50cykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhjb21wLmNvbXBvbmVudElkKTtcclxuICAgICAgICAgICAgY29tcC51cGRhdGUoZHQsIGN0eCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSW5zaWRlIEdyYXBoaWNzIENvbXBvbmVudFwiKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coY29tcC5jb21wb25lbnRJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgc2V0U2NlbmUoc2NlbmUpIHtcclxuICAgICAgICB2YXIgZ2V0ID0gc2NlbmUuZW5naW5lQ29tcG9uZW50cy5nZXQodGhpcy50YWcpO1xyXG4gICAgICAgIGlmIChnZXQpIHtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9R3JhcGhpY0VuZ2luZS5qcy5tYXAiLCJleHBvcnQgY29uc3QgUEhZU0lDU19UQUcgPSBcIlBIWVNJQ1NcIjtcclxuZXhwb3J0IGNvbnN0IEdSQVBISUNTX1RBRyA9IFwiR1JBUEhJQ1NcIjtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29tcG9uZW50VHlwZS5qcy5tYXAiLCJpbXBvcnQgeyBQSFlTSUNTX1RBRyB9IGZyb20gXCIuLi9jb25zdGFudHMvY29tcG9uZW50VHlwZS5qc1wiO1xyXG5leHBvcnQgY2xhc3MgUGh5c2ljc0VuZ2luZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnRhZyA9IFBIWVNJQ1NfVEFHO1xyXG4gICAgICAgIHRoaXMuY29tcG9uZW50cyA9IFtdO1xyXG4gICAgfVxyXG4gICAgdXBkYXRlKGR0KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJQaHlzaWNzIGVuZ2luZSBydW5uaW5nXCIpO1xyXG4gICAgICAgIGZvciAodmFyIGNvbXAgb2YgdGhpcy5jb21wb25lbnRzKSB7XHJcbiAgICAgICAgICAgIGNvbXAudXBkYXRlKGR0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UGh5c2ljc0VuZ2luZS5qcy5tYXAiLCJleHBvcnQgY2xhc3MgU2NyaXB0aW5nRW5naW5lIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMudGFnID0gXCJTQ1JJUFRJTkdcIjtcclxuICAgICAgICB0aGlzLmNvbXBvbmVudHMgPSBbXTtcclxuICAgIH1cclxuICAgIHVwZGF0ZShkdCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiU2NyaXB0aW5nIGVuZ2luZSBydW5uaW5nXCIpO1xyXG4gICAgICAgIGZvciAodmFyIGNvbXAgb2YgdGhpcy5jb21wb25lbnRzKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ29tcG9uZW50IHJ1bm5pbmdcIik7XHJcbiAgICAgICAgICAgIGNvbXAuY2FsbGJhY2soZHQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TY3JpcHRpbmdFbmdpbmUuanMubWFwIiwiZXhwb3J0IGNsYXNzIENvbnRleHRJbmZvIHtcclxuICAgIGNvbnN0cnVjdG9yKGdyYXBoaWNzQ29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy5ncmFwaGljc0NvbmZpZyA9IGdyYXBoaWNzQ29uZmlnO1xyXG4gICAgICAgIHRoaXMuZ3JhcGhpY3NDb25maWcgPSBncmFwaGljc0NvbmZpZztcclxuICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJzEwMCUnO1xyXG4gICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS53aWR0aCA9ICcxMDAlJztcclxuICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiO1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcclxuICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm1hcmdpbiA9IFwiMFwiO1xyXG4gICAgICAgIHRoaXMuc2V0dXAoKTtcclxuICAgICAgICB0aGlzLmNhbnZhcyA9IHRoaXMuZ2VuZXJhdGVDYW52YXMoKTtcclxuICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IDEwMDA7XHJcbiAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gNTAwO1xyXG4gICAgICAgIHRoaXMuY3R4ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgICAgIHRoaXMuZGl2ID0gdGhpcy5nZW5lcmF0ZURpdih0aGlzLmdyYXBoaWNzQ29uZmlnLnBhcmVudCk7XHJcbiAgICB9XHJcbiAgICBnZW5lcmF0ZURpdihwYXJlbnQpIHtcclxuICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgZGl2LmlkID0gcGFyZW50O1xyXG4gICAgICAgIGRpdi5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcclxuICAgICAgICBkaXYuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XHJcbiAgICAgICAgZGl2LnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XHJcbiAgICAgICAgZGl2LnN0eWxlLnpJbmRleCA9IFwiMVwiO1xyXG4gICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcIi9pbWFnZXMvdGVzdC5qcGdcIjtcclxuICAgICAgICBkaXYuYXBwZW5kQ2hpbGQodGhpcy5jYW52YXMpO1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZGl2KTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcInRlc3RcIik7XHJcbiAgICAgICAgcmV0dXJuIGRpdjtcclxuICAgIH1cclxuICAgIGdlbmVyYXRlQ2FudmFzKCkge1xyXG4gICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiQ0FOVkFTXCIpO1xyXG4gICAgICAgIGNhbnZhcy5pZCA9IHRoaXMuZ3JhcGhpY3NDb25maWcuY2FudmFzSUQ7XHJcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5wYXJzZVN0eWxlKHRoaXMuZ3JhcGhpY3NDb25maWcuc3R5bGUpKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkJlZm9yZVwiKTtcclxuICAgICAgICBjYW52YXMuc2V0QXR0cmlidXRlKCdzdHlsZScsIHRoaXMucGFyc2VTdHlsZSh0aGlzLmdyYXBoaWNzQ29uZmlnLnN0eWxlKSk7XHJcbiAgICAgICAgcmV0dXJuIGNhbnZhcztcclxuICAgIH1cclxuICAgIGdldEN0eCgpIHtcclxuICAgICAgICB2YXIgY2FudmFzID0gdGhpcy5nZXRDYW52YXMoKTtcclxuICAgICAgICByZXR1cm4gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICAgIH1cclxuICAgIGdldENhbnZhcygpIHtcclxuICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5ncmFwaGljc0NvbmZpZy5jYW52YXNJRCk7XHJcbiAgICAgICAgaWYgKGNhbnZhcyBpbnN0YW5jZW9mIEhUTUxDYW52YXNFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjYW52YXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcImVuZ2luZUNhbnZhcyBzaG91bGQgYmUgYSByZXNlcnZlZCBpZCBmb3IgRE9NIENvbXBvbmVudHNcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcGFyc2VTdHlsZShzdHlsZU9iamVjdCkge1xyXG4gICAgICAgIHZhciBjc3NBcnJheSA9IE9iamVjdC5lbnRyaWVzKHN0eWxlT2JqZWN0KS5tYXAoKFtrLCB2XSkgPT4gayArIFwiOlwiICsgdiArIFwiO1wiKTtcclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmdyYXBoaWNzQ29uZmlnLnBhcmVudCk7XHJcbiAgICAgICAgcmV0dXJuIGNzc0FycmF5LmpvaW4oXCIgXCIpO1xyXG4gICAgfVxyXG4gICAgc2V0dXAoKSB7XHJcbiAgICAgICAgaWYgKHRydWUpIHtcclxuICAgICAgICAgICAgdmFyIGltYWdlID0gbmV3IEltYWdlKCk7XHJcbiAgICAgICAgICAgIGltYWdlLnNyYyA9IFwiL2ltYWdlcy90ZXN0LmpwZ1wiO1xyXG4gICAgICAgICAgICBpbWFnZS5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcclxuICAgICAgICAgICAgaW1hZ2Uuc3R5bGUuekluZGV4ID0gXCItMVwiO1xyXG4gICAgICAgICAgICBpbWFnZS5zdHlsZS53aWR0aCA9IFwiMTAwJVwiO1xyXG4gICAgICAgICAgICBpbWFnZS5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpbWFnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbnRleHQuanMubWFwIiwiLyoqXHJcbiAqIERlc2NyaWJlcyB0aGUgQ1NTIHByb3BlcnRpZXMgb2YgdGhlIGNhbnZhcyBlbGVtZW50XHJcbiAqXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUGh5c2ljc0NvbmZpZyB7XHJcbn1cclxuZXhwb3J0IGNsYXNzIEdyYXBoaWNzQ29uZmlnIHtcclxuICAgIGNvbnN0cnVjdG9yKHBhcmVudCA9IFwiZW5naW5lRGl2XCIsIGNhbnZhc0lEID0gXCJlbmdpbmVDYW52YXNcIiwgc3R5bGUgPSB7fSwgYmFja2dyb3VuZCkge1xyXG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xyXG4gICAgICAgIHRoaXMuY2FudmFzSUQgPSBjYW52YXNJRDtcclxuICAgICAgICB0aGlzLnN0eWxlID0gc3R5bGU7XHJcbiAgICAgICAgdGhpcy5iYWNrZ3JvdW5kID0gYmFja2dyb3VuZDtcclxuICAgIH1cclxufVxyXG5leHBvcnQgY2xhc3MgU2NlbmVDb25maWcge1xyXG4gICAgY29uc3RydWN0b3IobmFtZSwgZW50aXRpZXMgPSBbXSwgYmFja2dyb3VuZCkge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5lbnRpdGllcyA9IGVudGl0aWVzO1xyXG4gICAgICAgIHRoaXMuYmFja2dyb3VuZCA9IGJhY2tncm91bmQ7XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0IGNsYXNzIEV2ZW50Q29uZmlnIHtcclxuICAgIGNvbnN0cnVjdG9yKGtleWJvYXJkLCBtb3VzZSkge1xyXG4gICAgICAgIHRoaXMua2V5Ym9hcmQgPSBrZXlib2FyZDtcclxuICAgICAgICB0aGlzLm1vdXNlID0gbW91c2U7XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0IGNsYXNzIENvbGxpc2lvbkNvbmZpZyB7XHJcbn1cclxuZXhwb3J0IGNsYXNzIFNjcmlwdGluZ0NvbmZpZyB7XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29uZmlnLmpzLm1hcCIsImltcG9ydCB7IFNjZW5lTWFuYWdlciB9IGZyb20gXCIuL1NjZW5lTWFuYWdlci5qc1wiO1xyXG5leHBvcnQgY2xhc3MgRW50aXR5TWFuYWdlciB7XHJcbiAgICBjb25zdHJ1Y3RvcihzY2VuZSkge1xyXG4gICAgICAgIHRoaXMuc2NlbmUgPSBzY2VuZTtcclxuICAgIH1cclxuICAgIGFkZEVudGl0eShlbnRpdHkpIHtcclxuICAgICAgICB2YXIgdW5pcXVlSWQgPSBTY2VuZU1hbmFnZXIuZ2V0VW5pcXVlSWQoKTtcclxuICAgICAgICBlbnRpdHkuaWQgPSB1bmlxdWVJZDtcclxuICAgICAgICBlbnRpdHkuc2NlbmUgPSB0aGlzLnNjZW5lO1xyXG4gICAgICAgIHRoaXMuc2NlbmUuZW50aXRpZXMuc2V0KHVuaXF1ZUlkLCBlbnRpdHkpO1xyXG4gICAgICAgIGZvciAodmFyIGNvbXAgb2YgZW50aXR5LmNvbXBvbmVudHMpIHtcclxuICAgICAgICAgICAgdmFyIGNvbXBMaXN0ID0gdGhpcy5zY2VuZS5lbmdpbmVDb21wb25lbnRzLmdldChjb21wLmVuZ2luZVRhZyk7XHJcbiAgICAgICAgICAgIGlmIChjb21wTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgY29tcExpc3QucHVzaCh0aGlzLmNyZWF0ZUNvbXBvbmVudChjb21wKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjb21wLmVuZ2luZVRhZyk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgb2YgdGhpcy5zY2VuZS5lbmdpbmVDb21wb25lbnRzLmtleXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGtleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcihcInNvbWV0aGluZyB3cm9uZyBhZGRpbmcgZW50aXRpZXNcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZW1vdmVFbnRpdHkoaWQpIHtcclxuICAgICAgICB2YXIgZW50aXR5ID0gdGhpcy5nZXRFbnRpdHkoaWQpO1xyXG4gICAgICAgIGlmIChlbnRpdHkpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgZSBvZiBlbnRpdHkuY29tcG9uZW50cykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGVuZ2luZUNvbXBMaXN0ID0gdGhpcy5zY2VuZS5lbmdpbmVDb21wb25lbnRzLmdldChlLmVuZ2luZVRhZyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZW5naW5lQ29tcExpc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVuZ2luZUNvbXBMaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbmdpbmVDb21wTGlzdFtpXS5lbnRpdHkgPT0gZW50aXR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmdpbmVDb21wTGlzdC5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGVudGl0eTtcclxuICAgIH1cclxuICAgIGdldEVudGl0eShpZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNjZW5lLmVudGl0aWVzLmdldChpZCk7XHJcbiAgICB9XHJcbiAgICBjcmVhdGVDb21wb25lbnQoY29tcCkge1xyXG4gICAgICAgIGNvbXAuY29tcG9uZW50SWQgPSBTY2VuZU1hbmFnZXIuZ2V0VW5pcXVlQ29tcG9uZW50SWQoKTtcclxuICAgICAgICByZXR1cm4gY29tcDtcclxuICAgIH1cclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1FbnRpdHlNYW5hZ2VyLmpzLm1hcCIsImltcG9ydCB7IFNjZW5lTWFuYWdlciB9IGZyb20gXCIuL21hbmFnZXJzL1NjZW5lTWFuYWdlci5qc1wiO1xyXG5pbXBvcnQgeyBFbnRpdHlNYW5hZ2VyIH0gZnJvbSBcIi4vbWFuYWdlcnMvRW50aXR5TWFuYWdlci5qc1wiO1xyXG5leHBvcnQgY2xhc3MgU2NlbmUge1xyXG4gICAgY29uc3RydWN0b3Ioc2NlbmVNYW5hZ2VyLCBzY2VuZUNvbmZpZywgc3lzdGVtcykge1xyXG4gICAgICAgIHRoaXMuc2NlbmVNYW5hZ2VyID0gc2NlbmVNYW5hZ2VyO1xyXG4gICAgICAgIHRoaXMubmFtZSA9IHNjZW5lQ29uZmlnLm5hbWU7XHJcbiAgICAgICAgdGhpcy5lbnRpdGllcyA9IG5ldyBNYXAoKTtcclxuICAgICAgICB0aGlzLmVuZ2luZUNvbXBvbmVudHMgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgdGhpcy5lbnRpdHlNYW5hZ2VyID0gbmV3IEVudGl0eU1hbmFnZXIodGhpcyk7XHJcbiAgICAgICAgZm9yICh2YXIgc3lzdGVtIG9mIHN5c3RlbXMpIHtcclxuICAgICAgICAgICAgdGhpcy5lbmdpbmVDb21wb25lbnRzLnNldChzeXN0ZW0udGFnLCBbXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGUgb2Ygc2NlbmVDb25maWcuZW50aXRpZXMpIHtcclxuICAgICAgICAgICAgdGhpcy5hZGRFbnRpdHkoZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZW5naW5lQ29tcG9uZW50cyk7XHJcbiAgICAgICAgdGhpcy5iYWNrZ3JvdW5kID0gc2NlbmVDb25maWcuYmFja2dyb3VuZDtcclxuICAgICAgICB0aGlzLnRpbWUgPSAwO1xyXG4gICAgfVxyXG4gICAgdXBkYXRlKGR0KSB7XHJcbiAgICAgICAgLy8gYXBwbHkgd29ybGQgcnVsZXNcclxuICAgIH1cclxuICAgIGFkZEVudGl0eShlbnRpdHkpIHtcclxuICAgICAgICB2YXIgdW5pcXVlSWQgPSBTY2VuZU1hbmFnZXIuZ2V0VW5pcXVlSWQoKTtcclxuICAgICAgICBlbnRpdHkuaWQgPSB1bmlxdWVJZDtcclxuICAgICAgICBlbnRpdHkuc2NlbmUgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuZW50aXRpZXMuc2V0KHVuaXF1ZUlkLCBlbnRpdHkpO1xyXG4gICAgICAgIGZvciAodmFyIGNvbXAgb2YgZW50aXR5LmNvbXBvbmVudHMpIHtcclxuICAgICAgICAgICAgdmFyIGNvbXBMaXN0ID0gdGhpcy5lbmdpbmVDb21wb25lbnRzLmdldChjb21wLmVuZ2luZVRhZyk7XHJcbiAgICAgICAgICAgIGlmIChjb21wTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgY29tcExpc3QucHVzaCh0aGlzLmNyZWF0ZUNvbXBvbmVudChjb21wKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjb21wLmVuZ2luZVRhZyArIFwiIHRhZ2dlZCBTeXN0ZW0gaXMgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwic3VjY2Vzc2Z1bGx5IGFkZGVkIGVudGl0eVwiKTtcclxuICAgIH1cclxuICAgIHJlbW92ZUVudGl0eShpZCkge1xyXG4gICAgICAgIHZhciBlbnRpdHkgPSB0aGlzLmdldEVudGl0eShpZCk7XHJcbiAgICAgICAgaWYgKGVudGl0eSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBlIG9mIGVudGl0eS5jb21wb25lbnRzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZW5naW5lQ29tcExpc3QgPSB0aGlzLmVuZ2luZUNvbXBvbmVudHMuZ2V0KGUuZW5naW5lVGFnKTtcclxuICAgICAgICAgICAgICAgIGlmIChlbmdpbmVDb21wTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZW5naW5lQ29tcExpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuZ2luZUNvbXBMaXN0W2ldLmVudGl0eSA9PSBlbnRpdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZ2luZUNvbXBMaXN0LnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZW50aXR5O1xyXG4gICAgfVxyXG4gICAgZ2V0RW50aXR5KGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZW50aXRpZXMuZ2V0KGlkKTtcclxuICAgIH1cclxuICAgIGNyZWF0ZUNvbXBvbmVudChjb21wKSB7XHJcbiAgICAgICAgY29tcC5jb21wb25lbnRJZCA9IFNjZW5lTWFuYWdlci5nZXRVbmlxdWVDb21wb25lbnRJZCgpO1xyXG4gICAgICAgIHJldHVybiBjb21wO1xyXG4gICAgfVxyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNjZW5lLmpzLm1hcCIsImltcG9ydCB7IFNjZW5lQ29uZmlnIH0gZnJvbSBcIi4uL2NvbmZpZy5qc1wiO1xyXG5pbXBvcnQgeyBTY2VuZSB9IGZyb20gXCIuLi9zY2VuZS5qc1wiO1xyXG5leHBvcnQgY2xhc3MgU2NlbmVNYW5hZ2VyIHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZyA9IFtuZXcgU2NlbmVDb25maWcoXCJEZWZhdWx0XCIpXSwgc3lzdGVtcywgaW5kZXggPSBjb25maWdbMF0ubmFtZSkge1xyXG4gICAgICAgIHRoaXMuc2NlbmVDb25maWdzID0gY29uZmlnO1xyXG4gICAgICAgIHRoaXMuc2NlbmVzID0gbmV3IE1hcCgpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29uZmlnLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBjdXJyQ29uZmlnID0gY29uZmlnW2ldO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkluIFNjZW5lIE1hbmFnZXJcIik7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN5c3RlbXMpO1xyXG4gICAgICAgICAgICB0aGlzLnNjZW5lcy5zZXQoY3VyckNvbmZpZy5uYW1lLCBuZXcgU2NlbmUodGhpcywgY3VyckNvbmZpZywgc3lzdGVtcykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNjZW5lQ29uZmlncyA9IGNvbmZpZztcclxuICAgICAgICB0aGlzLmN1cnJlbnRJZHggPSBpbmRleDtcclxuICAgICAgICB0aGlzLnN5c3RlbXMgPSBzeXN0ZW1zO1xyXG4gICAgfVxyXG4gICAgc3dpdGNoU2NlbmVzKGluZGV4KSB7XHJcbiAgICB9XHJcbiAgICBnZXRDdXJyZW50U2NlbmUoKSB7XHJcbiAgICAgICAgbGV0IGN1cnIgPSB0aGlzLnNjZW5lcy5nZXQodGhpcy5jdXJyZW50SWR4KTtcclxuICAgICAgICBpZiAoY3Vycikge1xyXG4gICAgICAgICAgICByZXR1cm4gY3VycjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwiQ2FudCBnZXQgY3VycmVudCBzY2VuZVwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB1cGRhdGUoZHQpIHtcclxuICAgICAgICBmb3IgKHZhciBrZXkgb2YgdGhpcy5zY2VuZXMpIHtcclxuICAgICAgICAgICAga2V5WzFdLnVwZGF0ZShkdCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgc3RhdGljIGdldFVuaXF1ZUlkKCkge1xyXG4gICAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIuaWQrKztcclxuICAgIH1cclxuICAgIHN0YXRpYyBnZXRVbmlxdWVDb21wb25lbnRJZCgpIHtcclxuICAgICAgICByZXR1cm4gU2NlbmVNYW5hZ2VyLmNvbXBvbmVudElkKys7XHJcbiAgICB9XHJcbn1cclxuU2NlbmVNYW5hZ2VyLmlkID0gMDtcclxuU2NlbmVNYW5hZ2VyLmNvbXBvbmVudElkID0gMDtcclxuY2xhc3MgRGVmYXVsdFNjZW5lIGV4dGVuZHMgU2NlbmUge1xyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNjZW5lTWFuYWdlci5qcy5tYXAiLCJleHBvcnQgY2xhc3MgQ29sbGlzaW9uU3lzdGVtIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMudGFnID0gXCJDT0xMSVNJT05cIjtcclxuICAgICAgICB0aGlzLmNvbXBvbmVudHMgPSBbXTtcclxuICAgIH1cclxuICAgIHVwZGF0ZShkdCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiQ29sbGlzaW9uIFN5c3RlbSBSdW5uaW5nXCIpO1xyXG4gICAgICAgIGZvciAodmFyIGNvbDEgb2YgdGhpcy5jb21wb25lbnRzKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGNvbDIgb2YgdGhpcy5jb21wb25lbnRzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29sMS5jaGVja0NvbGxpc2lvbihjb2wyKSAmJiBjb2wxICE9IGNvbDIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb2wxLmNvbGxpZGVzKGNvbDIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbGxpc2lvblN5c3RlbS5qcy5tYXAiLCJpbXBvcnQgeyBFdmVudEhhbmRsZXIgfSBmcm9tIFwiLi4vZXZlbnRzL0V2ZW50SGFuZGxlci5qc1wiO1xyXG5pbXBvcnQgeyBHcmFwaGljc0VuZ2luZSB9IGZyb20gXCIuLi9ncmFwaGljcy9HcmFwaGljRW5naW5lLmpzXCI7XHJcbmltcG9ydCB7IFBoeXNpY3NFbmdpbmUgfSBmcm9tIFwiLi4vcGh5c2ljcy9QaHlzaWNzRW5naW5lLmpzXCI7XHJcbmltcG9ydCB7IFNjcmlwdGluZ0VuZ2luZSB9IGZyb20gXCIuLi9zY3JpcHRpbmcvU2NyaXB0aW5nRW5naW5lLmpzXCI7XHJcbmltcG9ydCB7IENvbnRleHRJbmZvIH0gZnJvbSBcIi4vY29udGV4dC5qc1wiO1xyXG5pbXBvcnQgeyBTY2VuZU1hbmFnZXIgfSBmcm9tIFwiLi9tYW5hZ2Vycy9TY2VuZU1hbmFnZXIuanNcIjtcclxuaW1wb3J0IHsgQ29sbGlzaW9uU3lzdGVtIH0gZnJvbSBcIi4uL0NvbGxpc2lvbi9Db2xsaXNpb25TeXN0ZW0uanNcIjtcclxuZXhwb3J0IGNsYXNzIEVuZ2luZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihnYW1lQ29uZmlnID0geyBpc1NlcnZlcjogdHJ1ZSB9LCBzeXN0ZW1zKSB7XHJcbiAgICAgICAgdGhpcy5jYW52YXNJRCA9IFwiZW5naW5lQ2FudmFzXCI7XHJcbiAgICAgICAgdGhpcy5zeXN0ZW1zID0gW107XHJcbiAgICAgICAgdGhpcy50aW1lID0gMDtcclxuICAgICAgICB0aGlzLmVuZ2luZUNvbmZpZyA9IGdhbWVDb25maWc7XHJcbiAgICAgICAgaWYgKGdhbWVDb25maWcuZ3JhcGhpY3NDb25maWcpIHtcclxuICAgICAgICAgICAgdGhpcy5jb250ZXh0SW5mbyA9IG5ldyBDb250ZXh0SW5mbyhnYW1lQ29uZmlnLmdyYXBoaWNzQ29uZmlnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZW5naW5lQ29uZmlnLmV2ZW50Q29uZmlnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3lzdGVtcy5wdXNoKG5ldyBFdmVudEhhbmRsZXIodGhpcy5lbmdpbmVDb25maWcuZXZlbnRDb25maWcpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZW5naW5lQ29uZmlnLnBoeXNpY3NDb25maWcpIHtcclxuICAgICAgICAgICAgdGhpcy5zeXN0ZW1zLnB1c2gobmV3IFBoeXNpY3NFbmdpbmUoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmVuZ2luZUNvbmZpZy5zY3JpcHRpbmdDb25maWcgJiYgdGhpcy5jb250ZXh0SW5mbykge1xyXG4gICAgICAgICAgICB0aGlzLnN5c3RlbXMucHVzaChuZXcgU2NyaXB0aW5nRW5naW5lKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc3lzdGVtcykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBzeXMgb2Ygc3lzdGVtcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zeXN0ZW1zLnB1c2goc3lzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5lbmdpbmVDb25maWcuY29sbGlzaW9uQ29uZmlnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3lzdGVtcy5wdXNoKG5ldyBDb2xsaXNpb25TeXN0ZW0oKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmVuZ2luZUNvbmZpZy5ncmFwaGljc0NvbmZpZyAmJiB0aGlzLmNvbnRleHRJbmZvKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ29uc29sZS5jb250ZXh0IGluZm9cIik7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuY29udGV4dEluZm8pO1xyXG4gICAgICAgICAgICB0aGlzLmdyYXBoaWNzID0gbmV3IEdyYXBoaWNzRW5naW5lKHRoaXMuZW5naW5lQ29uZmlnLmdyYXBoaWNzQ29uZmlnLCB0aGlzLmNvbnRleHRJbmZvKTtcclxuICAgICAgICAgICAgdGhpcy5zeXN0ZW1zLnB1c2godGhpcy5ncmFwaGljcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2NlbmVNYW5hZ2VyID0gbmV3IFNjZW5lTWFuYWdlcih0aGlzLmVuZ2luZUNvbmZpZy5zY2VuZUNvbmZpZywgdGhpcy5zeXN0ZW1zKTtcclxuICAgICAgICB0aGlzLnJ1bm5pbmcgPSB0cnVlO1xyXG4gICAgICAgIGZvciAodmFyIHN5cyBvZiB0aGlzLnN5c3RlbXMpIHtcclxuICAgICAgICAgICAgdmFyIGNvbXAgPSB0aGlzLnNjZW5lTWFuYWdlci5nZXRDdXJyZW50U2NlbmUoKS5lbmdpbmVDb21wb25lbnRzLmdldChzeXMudGFnKTtcclxuICAgICAgICAgICAgaWYgKGNvbXApIHtcclxuICAgICAgICAgICAgICAgIHN5cy5jb21wb25lbnRzID0gY29tcDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRocm93IEVycm9yKFwiZXJyb3IgaW4gc3RhcnQgbWV0aG9kXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucnVubmluZyA9IGZhbHNlO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgIFxyXG4gICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnMTAwJSdcclxuICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUud2lkdGggPSAnMTAwJSdcclxuICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS53aWR0aCA9IFwiMTAwJVwiXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5tYXJnaW4gPSBcIjBcIlxyXG4gICAgICAgIHRoaXMuc2V0dXAoKVxyXG4gICAgICAgIHRoaXMuZGl2ID0gdGhpcy5nZW5lcmF0ZURpdih0aGlzLmVuZ2luZUNvbmZpZy5wYXJlbnQpIDtcclxuICAgICAgICB0aGlzLnJ1bm5pbmcgPSBmYWxzZVxyXG4gICAgICAgICovXHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgIHBhcnNlU3R5bGUoc3R5bGVPYmplY3Q6IE9iamVjdCk6ICBzdHJpbmcge1xyXG4gICAgICAgIHZhciBjc3NBcnJheTogc3RyaW5nW10gPSBPYmplY3QuZW50cmllcyhzdHlsZU9iamVjdCkubWFwKChbayx2XSkgPT4gayArIFwiOlwiICsgdiArIFwiO1wiKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZW5naW5lQ29uZmlnLnBhcmVudClcclxuICAgICAgICByZXR1cm4gY3NzQXJyYXkuam9pbihcIiBcIilcclxuICAgIH1cclxuICAgICovXHJcbiAgICAvKipcclxuICAgIGdlbmVyYXRlRGl2KHBhcmVudDogc3RyaW5nKSB7XHJcbiAgICAgICAgdmFyIGRpdjogSFRNTERpdkVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxyXG4gICAgICAgIGRpdi5pZCA9IHBhcmVudFxyXG4gICAgICAgIGRpdi5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIlxyXG4gICAgICAgIGRpdi5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIlxyXG4gICAgICAgIGRpdi5zdHlsZS53aWR0aCA9IFwiMTAwJVwiXHJcbiAgICAgICAgZGl2LnN0eWxlLnpJbmRleCA9IFwiMVwiXHJcbiAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IFwiL2ltYWdlcy90ZXN0LmpwZ1wiXHJcbiAgICAgICAgZGl2LmFwcGVuZENoaWxkKHRoaXMuZ2VuZXJhdGVDYW52YXMoKSlcclxuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRpdilcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJ0ZXN0XCIpXHJcbiAgICAgICAgcmV0dXJuIGRpdlxyXG4gICAgfVxyXG4gICAgZ2VuZXJhdGVDYW52YXMoKTogSFRNTEVsZW1lbnQge1xyXG4gICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiQ0FOVkFTXCIpXHJcbiAgICAgICAgY2FudmFzLmlkID0gdGhpcy5jYW52YXNJRFxyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMucGFyc2VTdHlsZSh0aGlzLmVuZ2luZUNvbmZpZy5zdHlsZSkpXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJCZWZvcmVcIilcclxuICAgICAgICBjYW52YXMuc2V0QXR0cmlidXRlKCdzdHlsZScsIHRoaXMucGFyc2VTdHlsZSh0aGlzLmVuZ2luZUNvbmZpZy5zdHlsZSkpXHJcbiAgICAgICAgcmV0dXJuIGNhbnZhc1xyXG4gICAgfVxyXG4gICAgZ2V0Q3R4KCkge1xyXG4gICAgICAgIHZhciBjYW52YXMgPSB0aGlzLmdldENhbnZhcygpXHJcbiAgICAgICAgcmV0dXJuIGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIilcclxuICAgIH1cclxuICAgIGdldENhbnZhcygpOiBIVE1MQ2FudmFzRWxlbWVudCB7XHJcbiAgICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuY2FudmFzSUQpXHJcbiAgICAgICAgaWYgKGNhbnZhcyBpbnN0YW5jZW9mIEhUTUxDYW52YXNFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjYW52YXNcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcImVuZ2luZUNhbnZhcyBzaG91bGQgYmUgYSByZXNlcnZlZCBpZCBmb3IgRE9NIENvbXBvbmVudHNcIilcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9XHJcbiAgICBcclxuICAgICAqXHJcbiAgICAgXHJcbiAgICBzZXR1cCgpIHtcclxuICAgICAgICB2YXIgY29uZmlnID0gdGhpcy5lbmdpbmVDb25maWdcclxuICAgICAgICBpZiAodHJ1ZSkge1xyXG4gICAgICAgICAgICB2YXIgaW1hZ2UgPSBuZXcgSW1hZ2UoKVxyXG4gICAgICAgICAgICBpbWFnZS5zcmMgPSBcIi9pbWFnZXMvdGVzdC5qcGdcIlxyXG4gICAgICAgICAgICBpbWFnZS5zdHlsZS5wb3NpdGlvbiA9XCJhYnNvbHV0ZVwiXHJcbiAgICAgICAgICAgIGltYWdlLnN0eWxlLnpJbmRleCA9IFwiLTFcIlxyXG4gICAgICAgICAgICBpbWFnZS5zdHlsZS53aWR0aCA9IFwiMTAwJVwiXHJcbiAgICAgICAgICAgIGltYWdlLnN0eWxlLmhlaWdodD0gXCIxMDAlXCJcclxuXHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaW1hZ2UpXHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgICovXHJcbiAgICBzdGFydCh0aW1lKSB7XHJcbiAgICAgICAgdGhpcy5ydW5uaW5nID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5ncmFwaGljcykge1xyXG4gICAgICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCh0aW1lc3RhbXApID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBkdCA9IHRpbWVzdGFtcCAtIHRoaXMudGltZTtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKGR0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMudGltZSA9IHRpbWVzdGFtcDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB3aGlsZSAodGhpcy5ydW5uaW5nKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZSh0aW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHVwZGF0ZShkdCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMpO1xyXG4gICAgICAgIGZvciAodmFyIHN5cyBvZiB0aGlzLnN5c3RlbXMpIHtcclxuICAgICAgICAgICAgc3lzLnVwZGF0ZShkdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2NlbmVNYW5hZ2VyLnVwZGF0ZShkdCk7XHJcbiAgICAgICAgdGhpcy50aW1lICs9IGR0O1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMudGltZSk7XHJcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSgodGltZXN0YW1wKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBkdCA9IHRpbWVzdGFtcCAtIHRoaXMudGltZTtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGUoZHQpO1xyXG4gICAgICAgICAgICB0aGlzLnRpbWUgPSB0aW1lc3RhbXA7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZW5naW5lLmpzLm1hcCIsImV4cG9ydCBjbGFzcyBUcmFuc2Zvcm0ge1xyXG4gICAgY29uc3RydWN0b3IoZW50aXR5LCBwb3MgPSB7IHg6IDAsIHk6IDAsIHo6IDAgfSwgdmVsID0geyB4OiAwLCB5OiAwLCB6OiAwIH0sIGFjY2VsID0geyB4OiAwLCB5OiAwLCB6OiAwIH0pIHtcclxuICAgICAgICB0aGlzLmVuZ2luZVRhZyA9IFwiUEhZU0lDU1wiO1xyXG4gICAgICAgIHRoaXMuZW50aXR5ID0gZW50aXR5O1xyXG4gICAgICAgIHRoaXMucG9zID0gcG9zO1xyXG4gICAgICAgIHRoaXMudmVsID0gdmVsO1xyXG4gICAgICAgIHRoaXMuYWNjZWwgPSBhY2NlbDtcclxuICAgIH1cclxuICAgIHVwZGF0ZShkdCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiUG9zaXRpb24gaXM6IFwiICsgdGhpcy5wb3MueCArIFwiIGFuZCBcIiArIHRoaXMucG9zLnkpO1xyXG4gICAgICAgIHRoaXMudmVsLnggPSB0aGlzLnZlbC54ICsgdGhpcy5hY2NlbC54ICogZHQ7XHJcbiAgICAgICAgdGhpcy52ZWwueSA9IHRoaXMudmVsLnkgKyB0aGlzLmFjY2VsLnkgKiBkdDtcclxuICAgICAgICB0aGlzLnZlbC56ID0gdGhpcy52ZWwueiArIHRoaXMuYWNjZWwueiAqIGR0O1xyXG4gICAgICAgIHRoaXMucG9zLnggPSB0aGlzLnBvcy54ICsgdGhpcy52ZWwueCAqIGR0O1xyXG4gICAgICAgIHRoaXMucG9zLnkgPSB0aGlzLnBvcy55ICsgdGhpcy52ZWwueSAqIGR0O1xyXG4gICAgICAgIHRoaXMucG9zLnogPSB0aGlzLnBvcy56ICsgdGhpcy52ZWwueiAqIGR0O1xyXG4gICAgfVxyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRyYW5zZm9ybS5qcy5tYXAiLCJleHBvcnQgY2xhc3MgUmVjdGFuZ2xlIHtcclxuICAgIHVwZGF0ZShkdCwgY3R4KSB7XHJcbiAgICAgICAgaWYgKGN0eCkge1xyXG4gICAgICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkgKiAyNTU7XHJcbiAgICAgICAgICAgIHZhciBnID0gTWF0aC5yYW5kb20oKSAqIDI1NTtcclxuICAgICAgICAgICAgdmFyIGIgPSBNYXRoLnJhbmRvbSgpICogMjU1O1xyXG4gICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gYHJnYihcclxuICAgICAgICAgICAgICAgICR7cn0sXHJcbiAgICAgICAgICAgICAgICAke2d9LFxyXG4gICAgICAgICAgICAgICAgJHtifSlgO1xyXG4gICAgICAgICAgICBjdHguZmlsbFJlY3QodGhpcy50cmFuc2Zvcm0ucG9zLngsIHRoaXMudHJhbnNmb3JtLnBvcy55LCAyMCwgMjApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnN0cnVjdG9yKGVudGl0eSwgdHJhbnNmb3JtKSB7XHJcbiAgICAgICAgdGhpcy5lbmdpbmVUYWcgPSBcIkdSQVBISUNTXCI7XHJcbiAgICAgICAgdGhpcy5lbnRpdHkgPSBlbnRpdHk7XHJcbiAgICAgICAgdGhpcy50cmFuc2Zvcm0gPSB0cmFuc2Zvcm07XHJcbiAgICB9XHJcbiAgICByZW5kZXIoY3R4KSB7XHJcbiAgICAgICAgaWYgKGN0eCkge1xyXG4gICAgICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkgKiAyNTU7XHJcbiAgICAgICAgICAgIHZhciBnID0gTWF0aC5yYW5kb20oKSAqIDI1NTtcclxuICAgICAgICAgICAgdmFyIGIgPSBNYXRoLnJhbmRvbSgpICogMjU1O1xyXG4gICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gYHJnYihcclxuICAgICAgICAgICAgICAgICR7cn0sXHJcbiAgICAgICAgICAgICAgICAke2d9LFxyXG4gICAgICAgICAgICAgICAgJHtifSlgO1xyXG4gICAgICAgICAgICBjdHguZmlsbFJlY3QodGhpcy50cmFuc2Zvcm0ucG9zLngsIHRoaXMudHJhbnNmb3JtLnBvcy55LCAyMCwgMjApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1SZWN0YW5nbGUuanMubWFwIiwiZXhwb3J0IGNsYXNzIE1vdXNlTGlzdGVuZXIge1xyXG4gICAgY29uc3RydWN0b3IoZW50aXR5LCBjbGlja01hcCkge1xyXG4gICAgICAgIHRoaXMuZW5naW5lVGFnID0gXCJFVkVOVEhBTkRMRVJcIjtcclxuICAgICAgICB0aGlzLmVudGl0eSA9IGVudGl0eTtcclxuICAgICAgICB0aGlzLmV2ZW50TWFwID0gbmV3IE1hcCgpO1xyXG4gICAgICAgIE9iamVjdC5lbnRyaWVzKGNsaWNrTWFwKS5tYXAoKFtrLCB2XSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmV2ZW50TWFwLnNldChrLCB2KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHVwZGF0ZShkdCwgY3R4KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJJbiBtb3VzZSBMaXN0ZW5lclwiKTtcclxuICAgIH1cclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1MaXN0ZW5lci5qcy5tYXAiLCJleHBvcnQgY2xhc3MgU2NyaXB0IHtcclxuICAgIGNvbnN0cnVjdG9yKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdGhpcy5lbmdpbmVUYWcgPSBcIlNDUklQVElOR1wiO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcclxuICAgIH1cclxuICAgIHVwZGF0ZShkdCwgY3R4KSB7XHJcbiAgICAgICAgdGhpcy5jYWxsYmFjayhkdCk7XHJcbiAgICB9XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U2NyaXB0LmpzLm1hcCIsIid1c2Ugc3RyaWN0JztcclxuZXhwb3J0IGNsYXNzIEJveENvbGxpZGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKGVudGl0eSwgcG9zLCBvbkNvbGxpc2lvbikge1xyXG4gICAgICAgIHRoaXMuZW5naW5lVGFnID0gXCJDT0xMSVNJT05cIjtcclxuICAgICAgICB0aGlzLmVudGl0eSA9IGVudGl0eTtcclxuICAgICAgICB0aGlzLmNvbGxpZGVUeXBlID0gXCJCb3hcIjtcclxuICAgICAgICB0aGlzLnNoYXBlID0ge1xyXG4gICAgICAgICAgICBwb3M6IHBvcyxcclxuICAgICAgICAgICAgZGltOiB7IGxlbmd0aDogMjAsIGhlaWdodDogMjAgfSxcclxuICAgICAgICAgICAgcm90OiAwXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnByZXYgPSB7XHJcbiAgICAgICAgICAgIHg6IHBvcy54LFxyXG4gICAgICAgICAgICB5OiBwb3MueSxcclxuICAgICAgICAgICAgejogcG9zLnpcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMub25Db2xsaXNpb24gPSBvbkNvbGxpc2lvbjtcclxuICAgIH1cclxuICAgIGNoZWNrQ29sbGlzaW9uKGNvbGxpZGVyKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJDaGVja2luZyBDb2xsaXNpb25cIik7XHJcbiAgICAgICAgbGV0IGRvZXNDb2xsaWRlID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IHJldCA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChjb2xsaWRlciBpbnN0YW5jZW9mIEJveENvbGxpZGVyKSB7XHJcbiAgICAgICAgICAgIGxldCByZWN0ID0gY29sbGlkZXIuc2hhcGU7XHJcbiAgICAgICAgICAgIGxldCByZWN0YW5nbGUgPSB0aGlzLnNoYXBlO1xyXG4gICAgICAgICAgICBpZiAocmVjdC5yb3QgPT0gMCAmJiByZWN0YW5nbGUucm90ID09IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZWN0LnBvcy54ICsgcmVjdC5kaW0ubGVuZ3RoID4gcmVjdGFuZ2xlLnBvcy54ICYmXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjdC5wb3MueCA8IHJlY3RhbmdsZS5wb3MueCArIHJlY3RhbmdsZS5kaW0ubGVuZ3RoICYmXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjdC5wb3MueSArIHJlY3QuZGltLmhlaWdodCA+IHJlY3RhbmdsZS5wb3MueSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHJlY3QucG9zLnkgPCByZWN0YW5nbGUucG9zLnkgKyByZWN0YW5nbGUuZGltLmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzbGFudGVkIGJveFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJub3QgYm94XCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmV0O1xyXG4gICAgfVxyXG4gICAgY29sbGlkZXMoY29sbGlkZXIpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkNvbGxpZGVkXCIpO1xyXG4gICAgICAgIHRoaXMub25Db2xsaXNpb24oY29sbGlkZXIpO1xyXG4gICAgfVxyXG4gICAgdXBkYXRlKGR0LCBjdHgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlVwZGF0aW5nIEJveCBDb2xsaWRlclwiKTtcclxuICAgICAgICB0aGlzLnByZXYueCA9IHRoaXMuc2hhcGUucG9zLng7XHJcbiAgICAgICAgdGhpcy5wcmV2LnkgPSB0aGlzLnNoYXBlLnBvcy55O1xyXG4gICAgICAgIHRoaXMucHJldi56ID0gdGhpcy5zaGFwZS5wb3MuejtcclxuICAgIH1cclxufVxyXG5leHBvcnQgY2xhc3MgQ2lyY2xlQ29sbGlkZXIge1xyXG4gICAgY29uc3RydWN0b3IoZW50aXR5LCBwb3MsIG9uQ29sbGlzaW9uKSB7XHJcbiAgICAgICAgdGhpcy5lbmdpbmVUYWcgPSBcIkNPTExJU0lPTlwiO1xyXG4gICAgICAgIHRoaXMuZW50aXR5ID0gZW50aXR5O1xyXG4gICAgICAgIHRoaXMuY29sbGlkZVR5cGUgPSBcIkJveFwiO1xyXG4gICAgICAgIHRoaXMuc2hhcGUgPSB7XHJcbiAgICAgICAgICAgIHBvczogcG9zLFxyXG4gICAgICAgICAgICBkaW06IHsgbGVuZ3RoOiAyMCwgaGVpZ2h0OiAyMCB9LFxyXG4gICAgICAgICAgICByb3Q6IDBcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMub25Db2xsaXNpb24gPSBvbkNvbGxpc2lvbjtcclxuICAgIH1cclxuICAgIGNoZWNrQ29sbGlzaW9uKGNvbGxpZGVyKSB7XHJcbiAgICAgICAgdmFyIGRvZXNDb2xsaWRlID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgY29sbGlkZXMoY29sbGlkZXIpIHtcclxuICAgICAgICB0aGlzLm9uQ29sbGlzaW9uKGNvbGxpZGVyKTtcclxuICAgIH1cclxuICAgIHVwZGF0ZShkdCwgY3R4KSB7XHJcbiAgICB9XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29sbGlkZXIuanMubWFwIiwiaW1wb3J0IHsgVHJhbnNmb3JtIH0gZnJvbSBcIi4uLy4uLy4uL2VuZ2luZS9zcmMvY29tcG9uZW50cy9QaHlzaWNzL3RyYW5zZm9ybS5qc1wiO1xyXG5pbXBvcnQgeyBSZWN0YW5nbGUgfSBmcm9tIFwiLi4vLi4vLi4vZW5naW5lL3NyYy9jb21wb25lbnRzL0dyYXBoaWNzL1JlY3RhbmdsZS5qc1wiO1xyXG5pbXBvcnQgeyBNb3VzZUxpc3RlbmVyIH0gZnJvbSBcIi4uLy4uLy4uL2VuZ2luZS9zcmMvY29tcG9uZW50cy9FdmVudC9MaXN0ZW5lci5qc1wiO1xyXG5pbXBvcnQgeyBTY3JpcHQgfSBmcm9tIFwiLi4vLi4vLi4vZW5naW5lL3NyYy9jb21wb25lbnRzL1NjcmlwdC9TY3JpcHQuanNcIjtcclxuaW1wb3J0IHsgQm94Q29sbGlkZXIgfSBmcm9tIFwiLi4vLi4vLi4vZW5naW5lL3NyYy9jb21wb25lbnRzL0NvbGxpc2lvbi9Db2xsaWRlci5qc1wiO1xyXG5leHBvcnQgY2xhc3MgUGxheWVyIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcywgdmVsKSB7XHJcbiAgICAgICAgdGhpcy50cmFuc2Zvcm0gPSBuZXcgVHJhbnNmb3JtKHRoaXMsIHBvcywgdmVsKTtcclxuICAgICAgICB2YXIgZnVuYyA9ICgpID0+IHtcclxuICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICB0aGlzLnRyYW5zZm9ybS5wb3MueCA9IE1hdGgucmFuZG9tKCkgKiAxMDAwO1xyXG4gICAgICAgICAgICB0aGlzLnRyYW5zZm9ybS5wb3MueSA9IE1hdGgucmFuZG9tKCkgKiA1MDA7XHJcbiAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtLnZlbC55ID0gMTtcclxuICAgICAgICAgICAgdGhpcy50cmFuc2Zvcm0udmVsLnggPSAxO1xyXG4gICAgICAgICAgICB2YXIgeCA9IE1hdGgucmFuZG9tKCkgKiAxMDAwO1xyXG4gICAgICAgICAgICB2YXIgeSA9IE1hdGgucmFuZG9tKCkgKiA1MDA7XHJcbiAgICAgICAgICAgIChfYSA9IHRoaXMuc2NlbmUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5hZGRFbnRpdHkobmV3IFBsYXllcih7IHg6IHgsIHk6IHksIHo6IDE1IH0sIHsgeDogMSwgeTogMSwgejogMCB9KSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgc2NyaXB0ID0gbmV3IFNjcmlwdCgoZHQpID0+IHtcclxuICAgICAgICAgICAgdmFyIHRvcFJpZ2h0ID0gdGhpcy50cmFuc2Zvcm0ucG9zLnggKyAyMDtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJJbiBQbGF5ZXIgU2NyaXB0XCIpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy50cmFuc2Zvcm0ucG9zLnggPCAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zZm9ybS5wb3MueCA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zZm9ybS52ZWwueCAqPSAtMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICgodGhpcy50cmFuc2Zvcm0ucG9zLnggKyAyMCkgPiAxMDAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zZm9ybS5wb3MueCA9IDEwMDAgLSAyMDtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtLnZlbC54ICo9IC0xO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRyYW5zZm9ybS5wb3MueSA8IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtLnBvcy55ID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtLnZlbC55ICo9IC0xO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKCh0aGlzLnRyYW5zZm9ybS5wb3MueSArIDIwKSA+IDUwMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50cmFuc2Zvcm0ucG9zLnkgPSA1MDAgLSAyMDtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtLnZlbC55ICo9IC0xO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJlciA9IG5ldyBSZWN0YW5nbGUodGhpcywgdGhpcy50cmFuc2Zvcm0pO1xyXG4gICAgICAgIHRoaXMubGlzdGVuZXIgPSBuZXcgTW91c2VMaXN0ZW5lcih0aGlzLCB7XHJcbiAgICAgICAgICAgIFwiY2xpY2tcIjogZnVuYyxcclxuICAgICAgICAgICAgXCJ0ZXN0MlwiOiAoKSA9PiB7IGNvbnNvbGUubG9nKFwidGVzdDJcIik7IH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgY29sbGlkZXJDYWxsYmFjayA9IChjb2xsKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtLnZlbC54ICo9IC0xO1xyXG4gICAgICAgICAgICB0aGlzLnRyYW5zZm9ybS52ZWwueSAqPSAtMTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBjb2xsaWRlciA9IG5ldyBCb3hDb2xsaWRlcih0aGlzLCB0aGlzLnRyYW5zZm9ybS5wb3MsIGNvbGxpZGVyQ2FsbGJhY2spO1xyXG4gICAgICAgIHRoaXMuY29tcG9uZW50cyA9IFtcclxuICAgICAgICAgICAgdGhpcy50cmFuc2Zvcm0sXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIsXHJcbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXIsXHJcbiAgICAgICAgICAgIHNjcmlwdCxcclxuICAgICAgICAgICAgY29sbGlkZXJcclxuICAgICAgICBdO1xyXG4gICAgfVxyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVBsYXllci5qcy5tYXAiLCJpbXBvcnQgeyBFbmdpbmUgfSBmcm9tIFwiLi4vZW5naW5lL3NyYy9jb3JlL2VuZ2luZS5qc1wiO1xyXG5pbXBvcnQgeyBHcmFwaGljc0NvbmZpZyB9IGZyb20gXCIuLi9lbmdpbmUvc3JjL2NvcmUvY29uZmlnLmpzXCI7XHJcbmltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuL3NjZW5lcy9lbnRpdGllcy9QbGF5ZXIuanNcIjtcclxud2luZG93Lm9ubG9hZCA9ICgpID0+IHtcclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICBcclxuICAgIHZhciBzb2NrZXQ6IFNvY2tldCA9IGlvKClcclxuXHJcbiAgICBsZXQgQ09ORklHOiBQaGFzZXIuVHlwZXMuQ29yZS5HYW1lQ29uZmlnID0ge1xyXG4gICAgICAgIHR5cGU6IFBoYXNlci5BVVRPLFxyXG4gICAgICAgIHRpdGxlOiAndGVzdCcsXHJcbiAgICAgICAgcGFyZW50OiAnZ2FtZScsXHJcbiAgICAgICAgc2NlbmU6IFtcclxuICAgICAgICAgICAgbmV3IFdhaXRpbmdTY2VuZShzb2NrZXQpXHJcbiAgICAgICAgXSxcclxuICAgICAgICBzY2FsZToge1xyXG4gICAgICAgICAgICBtb2RlOiBQaGFzZXIuU2NhbGUuQ0VOVEVSX0JPVEgsXHJcbiAgICAgICAgICAgIHdpZHRoOiB3aW5kb3cuc2NyZWVuLmF2YWlsV2lkdGggLSAod2luZG93Lm91dGVyV2lkdGggLSB3aW5kb3cuaW5uZXJXaWR0aCksXHJcbiAgICAgICAgICAgIGhlaWdodDogd2luZG93LnNjcmVlbi5hdmFpbEhlaWdodCAtICh3aW5kb3cub3V0ZXJIZWlnaHQgLSB3aW5kb3cuaW5uZXJIZWlnaHQpXHJcbiAgICAgICAgfSxcclxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwiIzNhYmEzYVwiLFxyXG4gICAgICAgIHVybDogd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lLFxyXG5cclxuICAgICAgICBkb206IHtcclxuICAgICAgICAgICAgY3JlYXRlQ29udGFpbmVyOiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgICAgIHNvY2tldC5vbihcImNvbm5lY3RcIiwgKCk9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDb25uZWN0ZWQnKVxyXG4gICAgICAgICAgICB2YXIgcm9vbUlkOiBzdHJpbmcgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWVcclxuICAgICAgICAgICAgdmFyIHJvb21BcnI6IHN0cmluZ1tdICA9IHJvb21JZC5zcGxpdChcIi9cIilcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocm9vbUFycltyb29tQXJyLmxlbmd0aC0xXSlcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocm9vbUlkKVxyXG4gICAgICAgICAgICBzb2NrZXQuZW1pdChcIkFkZFBsYXllclwiLCB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShcIlBsYXllck5hbWVcIiksIHJvb21BcnJbcm9vbUFyci5sZW5ndGgtMV0pXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgc29ja2V0Lm9uKFwiZGlzY29ubmVjdFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkaXNjb25uZWN0ZWQnKVxyXG4gICAgICAgIH0pXHJcbiAgICB2YXIgZ2FtZTogUGhhc2VyLkdhbWUgPSBuZXcgUGhhc2VyLkdhbWUoQ09ORklHKVxyXG4gICAgKi9cclxuICAgIGxldCBlbmdpbmUgPSBuZXcgRW5naW5lKHtcclxuICAgICAgICBpc1NlcnZlcjogZmFsc2UsXHJcbiAgICAgICAgcGh5c2ljc0NvbmZpZzoge30sXHJcbiAgICAgICAgZ3JhcGhpY3NDb25maWc6IG5ldyBHcmFwaGljc0NvbmZpZyhcInRlc3RcIiwgXCIxOTNhc1wiLCB7IFwiYmFja2dyb3VuZC1jb2xvclwiOiBcIndoaXRlXCIsIFwid2lkdGhcIjogXCIxMDAlXCIsIFwiaGVpZ2h0XCI6IFwiMTAwJVwiIH0pLFxyXG4gICAgICAgIHNjZW5lQ29uZmlnOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IFwiYXNcIixcclxuICAgICAgICAgICAgICAgIGVudGl0aWVzOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3IFBsYXllcih7IHg6IDAsIHk6IDAsIHo6IDE1IH0sIHsgeDogMC4wMDEsIHk6IDAsIHo6IDAgfSlcclxuICAgICAgICAgICAgICAgIF1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgZXZlbnRDb25maWc6IHtcclxuICAgICAgICAgICAga2V5Ym9hcmQ6IHRydWUsXHJcbiAgICAgICAgICAgIG1vdXNlOiB0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzY3JpcHRpbmdDb25maWc6IHt9LFxyXG4gICAgICAgIGNvbGxpc2lvbkNvbmZpZzoge31cclxuICAgIH0pO1xyXG4gICAgZW5naW5lLnN0YXJ0KDEpO1xyXG59O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOlsiRXZlbnRIYW5kbGVyIiwiY29uc3RydWN0b3IiLCJldmVudENvbmZpZyIsImtleWJvYXJkIiwibW91c2UiLCJ0aGlzIiwidGFnIiwiY29tcG9uZW50cyIsImV2ZW50cyIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInB1c2giLCJjb25zb2xlIiwibG9nIiwia2V5IiwidXBkYXRlIiwiZHQiLCJsZW4iLCJsZW5ndGgiLCJpIiwiY29tcCIsImV2ZW50TWFwIiwiZSIsImZ1bmMiLCJnZXQiLCJHcmFwaGljc0VuZ2luZSIsImdyYXBoaWNzQ29uZmlnIiwiY29udGV4dCIsImRvY3VtZW50IiwiZG9jdW1lbnRFbGVtZW50Iiwic3R5bGUiLCJoZWlnaHQiLCJ3aWR0aCIsImJvZHkiLCJtYXJnaW4iLCJlbnRpdGllcyIsImNvbnRleHRJbmZvIiwiY3R4IiwiY2FudmFzIiwiY2xlYXJSZWN0IiwiY29tcG9uZW50SWQiLCJzZXRTY2VuZSIsInNjZW5lIiwiZW5naW5lQ29tcG9uZW50cyIsIlBoeXNpY3NFbmdpbmUiLCJTY3JpcHRpbmdFbmdpbmUiLCJjYWxsYmFjayIsIkNvbnRleHRJbmZvIiwic2V0dXAiLCJnZW5lcmF0ZUNhbnZhcyIsImdldENvbnRleHQiLCJkaXYiLCJnZW5lcmF0ZURpdiIsInBhcmVudCIsImNyZWF0ZUVsZW1lbnQiLCJpZCIsInBvc2l0aW9uIiwiekluZGV4IiwiYmFja2dyb3VuZEltYWdlIiwiYXBwZW5kQ2hpbGQiLCJjYW52YXNJRCIsInBhcnNlU3R5bGUiLCJzZXRBdHRyaWJ1dGUiLCJnZXRDdHgiLCJnZXRDYW52YXMiLCJnZXRFbGVtZW50QnlJZCIsIkhUTUxDYW52YXNFbGVtZW50IiwiRXJyb3IiLCJzdHlsZU9iamVjdCIsImNzc0FycmF5IiwiT2JqZWN0IiwiZW50cmllcyIsIm1hcCIsImsiLCJ2Iiwiam9pbiIsImltYWdlIiwiSW1hZ2UiLCJzcmMiLCJHcmFwaGljc0NvbmZpZyIsImJhY2tncm91bmQiLCJTY2VuZUNvbmZpZyIsIm5hbWUiLCJFbnRpdHlNYW5hZ2VyIiwiYWRkRW50aXR5IiwiZW50aXR5IiwidW5pcXVlSWQiLCJTY2VuZU1hbmFnZXIiLCJnZXRVbmlxdWVJZCIsInNldCIsImNvbXBMaXN0IiwiZW5naW5lVGFnIiwia2V5cyIsImNyZWF0ZUNvbXBvbmVudCIsInJlbW92ZUVudGl0eSIsImdldEVudGl0eSIsImVuZ2luZUNvbXBMaXN0Iiwic3BsaWNlIiwiZ2V0VW5pcXVlQ29tcG9uZW50SWQiLCJzY2VuZU1hbmFnZXIiLCJzY2VuZUNvbmZpZyIsInN5c3RlbXMiLCJzeXN0ZW0iLCJNYXAiLCJlbnRpdHlNYW5hZ2VyIiwidGltZSIsImNvbmZpZyIsImluZGV4Iiwic2NlbmVDb25maWdzIiwic2NlbmVzIiwiY3VyckNvbmZpZyIsImN1cnJlbnRJZHgiLCJzd2l0Y2hTY2VuZXMiLCJnZXRDdXJyZW50U2NlbmUiLCJjdXJyIiwic3RhdGljIiwiQ29sbGlzaW9uU3lzdGVtIiwiY29sMSIsImNvbDIiLCJjaGVja0NvbGxpc2lvbiIsImNvbGxpZGVzIiwiRW5naW5lIiwiZ2FtZUNvbmZpZyIsImlzU2VydmVyIiwiZW5naW5lQ29uZmlnIiwicGh5c2ljc0NvbmZpZyIsInNjcmlwdGluZ0NvbmZpZyIsInN5cyIsImNvbGxpc2lvbkNvbmZpZyIsImdyYXBoaWNzIiwicnVubmluZyIsInN0YXJ0IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwidGltZXN0YW1wIiwiVHJhbnNmb3JtIiwicG9zIiwieCIsInkiLCJ6IiwidmVsIiwiYWNjZWwiLCJSZWN0YW5nbGUiLCJyIiwiTWF0aCIsInJhbmRvbSIsImciLCJiIiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJ0cmFuc2Zvcm0iLCJyZW5kZXIiLCJNb3VzZUxpc3RlbmVyIiwiY2xpY2tNYXAiLCJTY3JpcHQiLCJCb3hDb2xsaWRlciIsIm9uQ29sbGlzaW9uIiwiY29sbGlkZVR5cGUiLCJzaGFwZSIsImRpbSIsInJvdCIsInByZXYiLCJjb2xsaWRlciIsInJlY3QiLCJyZWN0YW5nbGUiLCJQbGF5ZXIiLCJzY3JpcHQiLCJyZW5kZXJlciIsImxpc3RlbmVyIiwiX2EiLCJjb2xsIiwib25sb2FkIl0sInNvdXJjZVJvb3QiOiIifQ==